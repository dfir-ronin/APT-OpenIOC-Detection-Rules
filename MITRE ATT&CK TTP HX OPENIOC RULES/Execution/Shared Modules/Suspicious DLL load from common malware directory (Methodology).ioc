<?xml version="1.0" encoding="utf-8"?>
<OpenIOC xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="2e343332-52a7-4460-91ea-ed5169c972c4" last-modified="2023-07-25T10:13:20Z" published-date="0001-01-01T00:00:00" xmlns="http://openioc.org/schemas/OpenIOC_1.1">
  <metadata>
    <short_description>Suspicious DLL load from common malware directory (Methodology)</short_description>
    <description>Adversaries may execute malicious payloads via loading shared modules. The Windows module loader can be instructed to load DLLs from arbitrary local paths and arbitrary Universal Naming Convention (UNC) network paths.

MITRE ATT&amp;CK REFERENCE: 
https://attack.mitre.org/techniques/T1129/</description>
    <authored_by>dfir-ronin</authored_by>
    <authored_date>2023-07-25T10:13:20Z</authored_date>
    <links />
  </metadata>
  <criteria>
    <Indicator operator="OR" id="8474615c-5aa8-4f18-9abb-0519ec75f413">
      <Indicator operator="AND" id="4e927e53-dde4-40ca-b496-5a049ffc3384">
        <IndicatorItem id="60633684-ee3e-46d7-bb7d-343e35735a36" condition="is" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/fileWriteEvent/process" type="endpoint" />
          <Content type="string">csc.exe</Content>
        </IndicatorItem>
        <IndicatorItem id="3d0536eb-3aa8-4883-86e5-4cf08fada4de" condition="is" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/fileWriteEvent/process" type="endpoint" />
          <Content type="string">java.exe</Content>
        </IndicatorItem>
        <IndicatorItem id="bb7aad49-2b7d-4722-877a-bc2192f6592f" condition="contains" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/fileWriteEvent/fileName" type="endpoint" />
          <Content type="string">pixpei2.dll</Content>
        </IndicatorItem>
        <IndicatorItem id="35b46669-7808-4421-968e-2ef2c753ba27" condition="contains" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/fileWriteEvent/filePath" type="endpoint" />
          <Content type="string">bpiipat2</Content>
        </IndicatorItem>
        <IndicatorItem id="578037c6-cc2e-4328-9b42-454be8d699b0" condition="is" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/fileWriteEvent/process" type="endpoint" />
          <Content type="string">javaw.exe</Content>
        </IndicatorItem>
        <IndicatorItem id="f000b362-a145-49cc-86fb-064f5e841888" condition="contains" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/fileWriteEvent/processPath" type="endpoint" />
          <Content type="string">C:\Program Files\</Content>
        </IndicatorItem>
        <Indicator operator="OR" id="dc159a5c-3310-4eb9-9e3a-cb99fd825d6c">
          <IndicatorItem id="4ecd9ea1-ba93-412f-904d-17569d6c20ad" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\Documents\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="36ec6da4-806a-43d0-8d58-1ae443440a2d" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\Downloads\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="d8c180b4-0fa4-4cbc-bc66-f861d05d2e75" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\Pictures\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="e60daaef-0520-4648-b788-3493f7daa686" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\Music\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="d2747c88-f01f-42b7-96df-6e8e1786a8a8" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\Videos\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="43865790-66aa-49e2-9f96-a435b83ca102" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\AppData\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="b6a89bc1-396b-490f-b207-80c58850f87e" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\AppData\\Roaming\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="28b8e110-4a15-457a-b68e-bcaf464f3084" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\AppData\\Local\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="4172f379-c585-4f88-8e02-07118bfd0dcd" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\AppData\\Local\\Temp\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="0d3cdc59-c811-45f3-ba96-6ba79197dad8" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\Public\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="7d9c88e5-452b-4af1-abb7-8b59f81f8344" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Programdata\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="e2541482-b7b0-4e2d-a91b-3791df8f4b38" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\TEMP\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="1f002653-7b20-4fc2-b98a-b737d6d27590" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\temp\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="db213360-7bcc-4f9e-9fb6-3c42ef0d8bb6" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/fileWriteEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Perflogs\\[^\\]+\.dll</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
      <Indicator operator="AND" id="7a29dcec-4086-4c41-b4ae-70b460499738">
        <IndicatorItem id="751d1bb9-b834-407e-8756-dc63198e3441" condition="is" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/imageLoadEvent/process" type="endpoint" />
          <Content type="string">java.exe</Content>
        </IndicatorItem>
        <IndicatorItem id="6eb7deb7-4e51-4e7f-843f-7aa301d13cfd" condition="is" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/imageLoadEvent/process" type="endpoint" />
          <Content type="string">csc.exe</Content>
        </IndicatorItem>
        <IndicatorItem id="26b76328-b0cb-4a81-bf80-d9bd75939afa" condition="is" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/imageLoadEvent/process" type="endpoint" />
          <Content type="string">javaw.exe</Content>
        </IndicatorItem>
        <IndicatorItem id="c197bda0-8e28-4e49-98e9-5a236483dfac" condition="contains" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/imageLoadEvent/processPath" type="endpoint" />
          <Content type="string">C:\Program Files\</Content>
        </IndicatorItem>
        <IndicatorItem id="25374e94-bb4b-4368-8bb2-b342c9b1c4fc" condition="contains" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/imageLoadEvent/filePath" type="endpoint" />
          <Content type="string">bpiipat2</Content>
        </IndicatorItem>
        <IndicatorItem id="c61a1418-e10e-400b-b5c2-8d9caeddaa32" condition="contains" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/imageLoadEvent/fileName" type="endpoint" />
          <Content type="string">pixpei2.dll</Content>
        </IndicatorItem>
        <IndicatorItem id="e90e9749-7498-4acf-b6a1-486c0f110534" condition="is" preserve-case="false" negate="true">
          <Context document="eventItem" search="eventItem/imageLoadEvent/process" type="endpoint" />
          <Content type="string">msiexec.exe</Content>
        </IndicatorItem>
        <Indicator operator="OR" id="c092ab09-fe4e-47d9-a468-520f6bbc6dd8">
          <IndicatorItem id="7d8afaa8-a84b-4224-8a06-5670b2839b40" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\Documents\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="53264bdc-3a22-4321-a8a2-d6866bc461ab" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\Downloads\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="307e1be3-2fd9-40f2-8467-b46dd07ef26a" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\Pictures\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="90eadc92-d2d5-4997-b33a-869f6889367d" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\Music\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="55697334-78a0-4261-a84e-8fb697fff4f2" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\Videos\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="bf6b909f-8c1c-4687-9bce-6e7c80294149" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\AppData\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="f5df00b9-dd6c-4659-97d9-a64395c697c2" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\AppData\\Roaming\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="19670fad-f8dc-4d16-8ec6-267387431d03" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\AppData\\Local\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="61cbada3-9b73-493c-9d41-625a9beb9a5a" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\[ .\-_\w]+\\AppData\\Local\\Temp\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="eaaaa4a9-c078-484b-a0e9-7ee5477285f9" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Users\\Public\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="68757433-0dc0-44e5-9ba9-1cec44cba2dd" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Programdata\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="7cc8a20d-8ee7-4fdd-b017-a38a9763150b" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\TEMP\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="14f23ff9-3553-49d9-814c-593141f6d852" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\temp\\[^\\]+\.dll</Content>
          </IndicatorItem>
          <IndicatorItem id="2f5ac03a-2036-4e45-8d24-61e6a5d35943" condition="matches" preserve-case="false" negate="false">
            <Context document="eventItem" search="eventItem/imageLoadEvent/fullPath" type="endpoint" />
            <Content type="string">C:\\Perflogs\\[^\\]+\.dll</Content>
          </IndicatorItem>
        </Indicator>
      </Indicator>
    </Indicator>
  </criteria>
  <parameters />
</OpenIOC>
